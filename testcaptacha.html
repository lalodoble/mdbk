<html>
  <head>
    <title>reCAPTCHA demo: Explicit render after an onload callback</title>
    <script type="text/javascript">
      var onloadCallback = function() {
        grecaptcha.render('html_element', {
          'sitekey' : '6Ldp6VogAAAAAKQjfhNXpfl-KC1-8q1SuNPaxU11'
        });
      };
    </script>
  </head>
  <body>
    
    <form action="?" method="POST" onsubmit="return submitUserForm();">
      <div id="html_element"></div>
      <br>
      <div class="g-recaptcha" data-sitekey="6Ldp6VogAAAAAKQjfhNXpfl-KC1-8q1SuNPaxU11" data-callback="verifyCaptcha"></div>
      <div id="g-recaptcha-error"></div>
      <input type="submit" value="Submit">
    </form>
    <script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit"
        async defer>
    </script>
    <script>
      var recaptcha_response = '';
      function submitUserForm() {
        console.log(recaptcha_response.length);
          if(recaptcha_response.length == 0) {
              document.getElementById('g-recaptcha-error').innerHTML = '<span style="color:red;">This field is required.</span>';
              return false;
          }
          return true;
      }
       
      function verifyCaptcha(token) {
        console.log("inside");
          recaptcha_response = token;
          document.getElementById('g-recaptcha-error').innerHTML = '';
      }
      </script>
  </body>
</html>